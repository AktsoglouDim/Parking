package hello;

import java.io.DataOutputStream;
import java.io.IOException;
import java.net.HttpURLConnection;
import java.net.MalformedURLException;
import java.net.ProtocolException;
import java.net.URL;
import java.nio.charset.StandardCharsets;

public class TestApp {

    public static void main(String[] args) {
    	String urlParameters  = "param1=a&param2=b&param3=c";
    	byte[] postData       = urlParameters.getBytes( StandardCharsets.UTF_8 );
    	int    postDataLength = postData.length;
    	String request        = "http://localhost:8080/greeting";
    	URL url = null;
		try {
			url = new URL( request );
		} catch (MalformedURLException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}
    	HttpURLConnection conn = null;
		try {
			conn = (HttpURLConnection) url.openConnection();
		} catch (IOException e1) {
			// TODO Auto-generated catch block
			e1.printStackTrace();
		}           
    	conn.setDoOutput( true );
    	conn.setInstanceFollowRedirects( false );
    	try {
			conn.setRequestMethod( "POST" );
		} catch (ProtocolException e) {
			e.printStackTrace();
		}
    	conn.setRequestProperty( "Content-Type", "application/x-www-form-urlencoded"); 
    	conn.setRequestProperty( "charset", "utf-8");
    	conn.setRequestProperty( "Content-Length", Integer.toString( postDataLength ));
    	conn.setUseCaches( false );
    	System.out.println("Getting here\n");
    	try( DataOutputStream wr = new DataOutputStream( conn.getOutputStream())) {
    	   wr.write( postData );
    	} catch (IOException e) {
    		e.printStackTrace();
		}
    }
}